summary: Save New Profile and Rule Settings
description:
  $ref: ./description.md
tags:
  - Profiles
requestBody:
  required: true
  content:
    application/json:
      schema:
        oneOf:
          - $ref: ./requests/save-new-profile.yml
          - $ref: ./requests/save-rule-settings-to-profile.yml
        example:
          included:
            - type: rules
              id: EC2-055
              attributes:
                enabled: false
                extraSettings:
                  - type: single-number-value
                    name: cpuUtilizationThreshold
                    value: 2
                riskLevel: HIGH
                provider: aws
            - type: rules
              id: EC2-071
              attributes:
                enabled: false
                riskLevel: HIGH
                provider: aws
            - type: rules
              id: RTM-007
              attributes:
                enabled: false
                extraSettings:
                  - type: multiple-ip-values
                    name: authorisedIps
                    values:
                      - value:
                        default:
                  - name: ttl
                    type: ttl
                    value: 24
                    ttl: true
                riskLevel: HIGH
                provider: aws
            - type: rules
              id: S3-006
              attributes:
                enabled: true
                exceptions:
                  resources:
                    - fadfad
                  tags:
                    - adsfs
                extraSettings:
                riskLevel: VERY_HIGH
                provider: aws
            - type: rules
              id: SNS-002
              attributes:
                enabled: false
                riskLevel: HIGH
                provider: aws
          data:
            type: profiles
            id: d9yHTrzP0
            attributes:
              name: hemen test 1
              description: hemen test 1
            relationships:
              ruleSettings:
                data:
                  - type: rules
                    id: EC2-055
                  - type: rules
                    id: EC2-071
                  - type: rules
                    id: RTM-007
                  - type: rules
                    id: S3-006
                  - type: rules
                    id: SNS-002
responses:
  200:
    description: OK
    content:
      application/json:
        schema:
          oneOf:
            - $ref: ./responses/200-save-new-profile.yml
            - $ref: ../../shared-schemas/responses/200-profile-including-rule-settings.yml
          example:
            included:
              - type: rules
                id: EC2-055
                attributes:
                  enabled: false
                  extraSettings:
                    - type: single-number-value
                      name: cpuUtilizationThreshold
                      value: 2
                  riskLevel: HIGH
                  provider: aws
              - type: rules
                id: EC2-071
                attributes:
                  enabled: false
                  riskLevel: HIGH
                  provider: aws
              - type: rules
                id: RTM-007
                attributes:
                  enabled: false
                  extraSettings:
                    - type: multiple-ip-values
                      name: authorisedIps
                      values:
                        - value:
                          default:
                    - name: ttl
                      type: ttl
                      value: 24
                      ttl: true
                  riskLevel: HIGH
                  provider: aws
              - type: rules
                id: S3-006
                attributes:
                  enabled: true
                  exceptions:
                    resources:
                      - fadfad
                    tags:
                      - adsfs
                  extraSettings:
                  riskLevel: VERY_HIGH
                  provider: aws
              - type: rules
                id: SNS-002
                attributes:
                  enabled: false
                  riskLevel: HIGH
                  provider: aws
            data:
              type: profiles
              id: d9yHTrzP0
              attributes:
                name: hemen test 1
                description: hemen test 1
              relationships:
                ruleSettings:
                  data:
                    - type: rules
                      id: EC2-055
                    - type: rules
                      id: EC2-071
                    - type: rules
                      id: RTM-007
                    - type: rules
                      id: S3-006
                    - type: rules
                      id: SNS-002
              401:
                description: Unauthorized. The requesting user does not have enough privilege.
                content:
                  application/json:
                    schema:
                      $ref: ../../shared-schemas/responses/401.yml
              422:
                description: Unprocessed Entity. Validation error.
                content:
                  application/json:
                    schema:
                      $ref: ../../shared-schemas/responses/422-unprocessed-entity.yml
security:
  - ApiKeyAuth: []
